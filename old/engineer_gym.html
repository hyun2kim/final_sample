<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Engineering Gym Architecture</title>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({
            startOnLoad: true,
            theme: 'base', // ê¸°ë³¸ í…Œë§ˆ ì‚¬ìš©
            themeVariables: {
                primaryColor: '#e3f2fd', // ê¸°ë³¸ ë°°ê²½ìƒ‰ (Frontend)
                edgeLabelBackground: '#ffffff',
                tertiaryColor: '#f5f5f5' // ì„œë¸Œê·¸ë˜í”„ ë°°ê²½ìƒ‰
            },
            flowchart: {
                curve: 'basis', // ë¶€ë“œëŸ¬ìš´ ê³¡ì„ 
                padding: 20     // ë…¸ë“œ ê°„ ê°„ê²©
            }
        });
    </script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f9f9f9;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        .mermaid-container {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            width: 95%;
            max-width: 1600px;
            overflow: auto;
            /* ë‹¤ì´ì–´ê·¸ë¨ì´ í´ ê²½ìš° ìŠ¤í¬ë¡¤ í—ˆìš© */
        }

        h2 {
            text-align: center;
            color: #333;
            margin-bottom: 25px;
        }
    </style>
</head>

<body>
    <div class="mermaid-container">
        <h2>Engineering Gym: AI-Powered Practice Platform Architecture</h2>
        <div class="mermaid">
            %%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#e3f2fd', 'edgeLabelBackground':'#ffffff',
            'tertiaryColor': '#f5f5f5'}}}%%
            graph LR
            %% --- ìŠ¤íƒ€ì¼ ì •ì˜ ---
            classDef frontend fill:#e3f2fd,stroke:#1565c0,stroke-width:2px,color:#0d47a1,rx:5,ry:5;
            classDef gateway fill:#fff3e0,stroke:#e65100,stroke-width:2px,color:#e65100,rx:5,ry:5;
            classDef processing fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px,color:#1b5e20,rx:2,ry:2;
            classDef ai fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#4a148c,rx:5,ry:5;
            classDef storage fill:#eceff1,stroke:#546e7a,stroke-width:2px,color:#37474f,rx:2,ry:2,stroke-dasharray: 5 5;
            classDef db fill:#eceff1,stroke:#546e7a,stroke-width:3px,color:#37474f,shape:cylinder;

            %% --- 1. ì‚¬ìš©ì ì…ë ¥ ê³„ì¸µ (ì™¼ìª½) ---
            subgraph "1ï¸âƒ£ Client Layer"
            direction TB
            UI[ğŸ’» Web/Mobile UI]
            CodeEditor[âŒ¨ï¸ Code Editor]
            DiagramEditor[ğŸ“Š Diagram Editor]
            end

            %% --- 2. ê²Œì´íŠ¸ì›¨ì´ ë° ì¸ì¦ ---
            subgraph "2ï¸âƒ£ Gateway & Auth"
            direction TB
            Gateway[ğŸšª API Gateway]
            RateLimit[â±ï¸ Rate Limiter]
            Auth[ğŸ” Auth Service<br />(JWT)]
            end

            %% --- 3 & 4. í•µì‹¬ ì²˜ë¦¬ ë° ë°ì´í„° (ì¤‘ì•™) ---
            subgraph "Core Engine & Data"
            direction TB
            Router[ğŸ”„ Practice Router]

            subgraph "ğŸ“š Content DBs"
            direction LR
            ScenarioDB[(Scenario DB)]:::db
            ConstraintsDB[(Constraints DB)]:::db
            TestCaseDB[(Test Cases)]:::db
            TemplateDB[(Templates)]:::db
            end

            %% 5ê°€ì§€ ì‹¤ìŠµ íŠ¸ë™ ë³‘ë ¬ ë°°ì¹˜
            subgraph "âš™ï¸ 5 Practice Tracks"
            direction TB
            subgraph "ğŸ’» Code Track"
            CodeHandler[Handler] --> Sandbox[ğŸ“¦ Sandbox] --> PerfAnalyzer[âš¡ Perf Check] --> QualityCheck[âœ¨ Quality]
            end
            subgraph "ğŸ› Debug Track"
            DebugHandler[Handler] --> BugVerifier[ğŸ” Verifier] --> DiffAnalyzer[ğŸ“Š Diff] --> RefactorCheck[ğŸ§¹ Refactor]
            end
            subgraph "ğŸ—ï¸ System Track"
            SystemHandler[Handler] --> MermaidParser[ğŸ“ Parser] --> ArchReviewer[ğŸ›ï¸ Reviewer] --> TradeoffAnalyzer[âš–ï¸
            Tradeoff]
            end
            subgraph "ğŸš¨ Ops Track"
            OpsHandler[Handler] --> MetricsCollector[ğŸ“Š Analyzer] --> DecisionEngine[ğŸ¯ Validator] --> MTTRCalculator[â±ï¸
            MTTR]
            end
            subgraph "ğŸ¤– Agent Track"
            AgentHandler[Handler] --> PromptEvaluator[ğŸ“ Prompt Eval] --> RAGAnalyzer[ğŸ” RAG Check] -->
            HallucinationDetector[ğŸ­ Detector]
            end
            end
            end

            %% --- 5 & 6. í‰ê°€ ë° AI (ì˜¤ë¥¸ìª½) ---
            subgraph "ğŸ§  Evaluation & AI Brain"
            direction TB

            subgraph "5ï¸âƒ£ Evaluation Engine"
            TestManager[ğŸ§ª Test Case Manager]
            MetricsAgg[ğŸ“ˆ Metrics Aggregator]
            ObjectiveFB[âœ… Objective Feedback]
            ChecklistEngine[ğŸ“‹ Checklist Engine]
            TestManager --> MetricsAgg --> ObjectiveFB --> ChecklistEngine
            end

            subgraph "6ï¸âƒ£ AI/LLM Layer"
            LLMOrch[ğŸ¼ LLM Orchestrator]
            QuestionGen[â“ Question Gen]
            CoachFB[ğŸ’¬ Coach Feedback]
            AltSolution[ğŸ’¡ Alt Solutions]
            LLMOrch --> QuestionGen & CoachFB & AltSolution
            end
            end

            %% --- 7. ì‚¬ìš©ì ì§„ì²™ë„ (ì˜¤ë¥¸ìª½ í•˜ë‹¨) ---
            subgraph "7ï¸âƒ£ User Progress"
            direction TB
            ProgressTracker[ğŸ“ Tracker]
            UserHistory[(ğŸ’¾ History DB)]:::db
            Recommender[ğŸ¯ Next Challenge]
            ProgressTracker --> UserHistory --> Recommender
            end

            %% --- 8. ì¸í”„ë¼ (í•˜ë‹¨ ë°°ê²½) ---
            subgraph "8ï¸âƒ£ Infrastructure Base"
            direction LR
            Storage[â˜ï¸ Object Storage<br />S3]:::storage
            Cache[âš¡ Cache<br />Redis]:::storage
            Queue[ğŸ“¨ Message Queue<br />Kafka]:::storage
            Monitoring[ğŸ“Š Monitoring &<br />Logging]:::storage
            end

            %% ========== ì£¼ìš” íë¦„ ì—°ê²° (êµµì€ ì„ ) ==========
            %% Client -> Gateway
            UI & CodeEditor & DiagramEditor ==> Gateway
            Gateway ==> RateLimit ==> Auth ==> Router

            %% Router -> Tracks
            Router ==> CodeHandler & DebugHandler & SystemHandler & OpsHandler & AgentHandler

            %% DB -> Router/Managers (ë°ì´í„° ê³µê¸‰)
            ScenarioDB & ConstraintsDB -.-> Router
            TestCaseDB & TemplateDB -.-> TestManager

            %% Tracks -> Evaluation Engine (ê²°ê³¼ ì·¨í•©)
            QualityCheck & RefactorCheck & TradeoffAnalyzer & MTTRCalculator & HallucinationDetector ==> TestManager

            %% Evaluation -> AI
            ChecklistEngine ==> LLMOrch

            %% AI -> Progress -> UI Loop (í”¼ë“œë°± ë£¨í”„)
            AltSolution & CoachFB ==> ProgressTracker
            Recommender -.->|Next Recommendation| UI

            %% ========== ì¸í”„ë¼ ì—°ê²° (ì ì„ ) ==========
            Storage & Cache & Queue & Monitoring -.- Router & TestManager & LLMOrch

            %% ========== ìŠ¤íƒ€ì¼ ì ìš© ==========
            class UI,CodeEditor,DiagramEditor frontend;
            class Gateway,RateLimit,Auth gateway;
            class
            Router,CodeHandler,Sandbox,PerfAnalyzer,QualityCheck,DebugHandler,BugVerifier,DiffAnalyzer,RefactorCheck,SystemHandler,MermaidParser,ArchReviewer,TradeoffAnalyzer,OpsHandler,MetricsCollector,DecisionEngine,MTTRCalculator,AgentHandler,PromptEvaluator,RAGAnalyzer,HallucinationDetector
            processing;
            class
            TestManager,MetricsAgg,ObjectiveFB,ChecklistEngine,LLMOrch,QuestionGen,CoachFB,AltSolution,ProgressTracker,Recommender
            ai;
        </div>
    </div>
</body>

</html>